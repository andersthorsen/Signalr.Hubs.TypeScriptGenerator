@using System
@using System.Linq;
@using GeniusSports.Signalr.Hubs.TypeScriptGenerator.Models
@model GeniusSports.Signalr.Hubs.TypeScriptGenerator.Models.TypesModel

//------------------------------------------------------------------------------
// <auto-generated>
//
// This code was generated by a tool.
//
// Changes to this file may cause incorrect behavior and will be lost if
// the code is regenerated.
//
// @DateTime.UtcNow.ToString("u")
// https://github.com/geniussportsgroup/Signalr.Hubs.TypeScriptGenerator
//
// </auto-generated>
//------------------------------------------------------------------------------

@foreach (var referencePath in Model.ReferencePaths)
{
<text>/// <reference path="@referencePath" /></text>
}

// Hubs

interface SignalR
{
	@foreach (MemberTypeInfo type in Model.Hubs)
	{
	<text>@(type.Name) : @(type.TypeScriptType);</text>
	}
}

// Service contracts
@foreach(var grouping in Model.ServiceContracts.GroupBy(x => x.ModuleName))
{
<text>
declare module @grouping.Key
{
	@foreach (var serviceInfo in grouping){
	<text>interface @serviceInfo.InterfaceName
	{
		server : @(serviceInfo.ServerFullType);
		@if (serviceInfo.ClientType == "any")
		{
<text>		// TODO: Hub does not have a Client Interface as a generic argument - it is recommended to add one.</text>
		}
		client : @Raw(serviceInfo.ClientType);
	}

	interface @serviceInfo.ServerType
	{
		@foreach (FunctionDetails functionDetails in serviceInfo.ServerFunctions)
		{
		<text>@Raw(functionDetails.Name + functionDetails.Arguments) : @Raw(functionDetails.ReturnType);</text>
		}
	}</text>
	}
}
</text>
}
// Clients
@foreach (var grouping in Model.Clients.GroupBy(x => x.ModuleName))
{
<text>
declare module @grouping.Key
{
	@foreach (var clientInfo in grouping){
	<text>interface @clientInfo.InterfaceName
	{
		@foreach (FunctionDetails functionDetails in clientInfo.FunctionDetails)
		{
		<text>@Raw(functionDetails.Name) : @Raw(functionDetails.Arguments) => void;</text>
		}
	}</text>
	}
}
</text>
}
// Data contracts
@foreach (var grouping in Model.DataContracts.GroupBy(x => x.ModuleName))
{
<text>
declare module @grouping.Key
{
	@foreach (var dataContractInfo in grouping)
	{
	<text>interface @dataContractInfo.InterfaceName @dataContractInfo.ExtendsDeclaration
	{
		@foreach (MemberTypeInfo property in dataContractInfo.Properties)
		{
		<text>@Raw(property.DeclaredName) : @Raw(property.TypeScriptType);</text>
		}
	}</text>
	}
}
</text>
}
